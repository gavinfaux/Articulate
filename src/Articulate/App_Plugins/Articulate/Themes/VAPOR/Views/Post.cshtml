@using Articulate
@using Umbraco.Cms.Core.Models.PublishedContent
@using Umbraco.Extensions

@model global::Articulate.Models.PostModel
@{
    Layout = "Master.cshtml";
    ViewBag.CssBodyClass = "post-template";
	var absUrl = Model.Url(mode: UrlMode.Absolute);
}

@section header
{
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/themes/prism.min.css" integrity="sha256-ko4j5rn874LF8dHwW29/xabhh8YBleWfvxb8nQce4Fc=" crossorigin="anonymous">}

<main class="content" role="main">

    <article class="post">

        <header>
            <h1 class="post-title">@Model.Name</h1>
            <div class="post-meta">
                <time datetime="@Model.PublishedDate.ToString("yyyy-MM-dd")">
                    @Model.PublishedDate.ToString("dddd, MMMM dd, yyyy")
                </time>
            </div>
            @await Html.ThemedPartialAsync(Model, "PostTags")
        </header>

        <section class="post-content">

            @if (!Model.CroppedPostImageUrl.IsNullOrWhiteSpace())
            {
                <img class="postImage" alt="@Model.Name" src="@Model.CroppedPostImageUrl" />
            }

            <div>
                @Model.Body
            </div>

        </section>

        <section class="share">
            <p class="info prompt">Share this post</p>
            <a href="http://twitter.com/share?text=@Model.Name&url=@absUrl"
               onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-2x fa-fw fa-twitter"></i> <span class="hidden">Twitter</span>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=@absUrl"
               onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-2x fa-fw fa-facebook-square"></i> <span class="hidden">Facebook</span>
            </a>
        </section>

        <footer class="post-footer">

            @if (!Model.Author.Name.IsNullOrWhiteSpace())
            {
                <section class="author">
                    @if (Model.Author.Image != null)
                    {
                        var thumbnail = Model.Author.Image.GetCropUrl("blogPost");
                        if (thumbnail != null)
                        {
                            <div class="authorimage" style="background: url(@thumbnail)"></div>
                        }
                    }
                    <p class="attr">Author</p>
                    <h4>
                        @if (!Model.Author.BlogUrl.IsNullOrWhiteSpace())
                        {
                            <a href="@Model.Author.BlogUrl">@Model.Author.Name</a>
                        }
                        else
                        {
                            @Model.Author.Name
                        }
                    </h4>
                    @if (!Model.Author.Bio.IsNullOrWhiteSpace())
                    {
                        <p class="bio">@Model.Author.Bio</p>
                    }
                </section>
            }

        </footer>

        @if (Model.EnableComments)
        {
            @await Html.ThemedPartialAsync(Model, "CommentsDisqus")
            @*@await Html.ThemedPartialAsync(Model, "CommentsFacebook")*@
        }

    </article>

</main>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/components/prism-core.min.js" integrity="sha256-bKrTFt2ZHyT4AE4LnBnAVctYKf9l6XP77kBvltgbjn4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.30.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
